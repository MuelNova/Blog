nova在这篇博客中分享了他在DASCTF2023二进制专场中的一道PWN题目的解题过程。这次比赛的PWN题质量比较高，但由于题量较大且nova在备考，所以他只对题目做了浅浅复现。

## a_dream题解

这道题目考察的是多线程的栈迁移。主要要点包括：

- 主线程在子线程创建后开的沙箱不影响子线程
- 子线程的栈由mmap开辟，与libc偏移相同
- 子线程与父线程使用同一个GOT/PLT表

攻击步骤：

1. 将栈迁移到bss段上，并将write的GOT表改为父线程里的read。
2. 利用puts函数泄露libc地址，从而获取子线程栈地址。
3. 最终实现ret2libc。

在过程中需要注意的是修改完write的GOT表后，虽然只能溢出0x10，但由于特殊的栈布局，可以通过特定操作实现0x20字节的控制，这样可以成功执行pop rdi、got['puts']、plt['puts']和magic_read等操作。

nova在遇到调试困难时建议使用gdb命令`set scheduler-locking step`，可以有效避免因为中断带来的调试复杂。

通过这些详细的步骤和注意事项，nova成功地解出了这道PWN题目。