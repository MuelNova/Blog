这篇文章由 nova 撰写，主要分享了2022年西湖论剑CTF比赛中PWN题目的解题过程和复现情况。

在分析“babycalc”题目时，nova首先使用了Z3 Prover求解解密过程，并注意到 `buf` 可以溢出修改变量 `i` 的值，进而修改字节值。 `buf[(int)read]` 可以通过填满0x100字节来覆写 `rbp` 的最高位，使其返回到另一个 `leave; ret`，以实现栈迁移。

Nova提出通过修改返回地址最后一字节来增加攻击成功率，同时利用puts泄露libc、第二次打 one_gadget 或返回 system 实现进一步攻击。Nova还提供了相对复杂的攻击脚本供读者参考。

文章中还包含了相关附件仓库链接供进一步研究。